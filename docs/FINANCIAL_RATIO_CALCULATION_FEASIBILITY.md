# 재무비율 계산 가능성 점검 보고서

**점검일:** 2025-10-21
**점검자:** Claude
**점검 범위:** Day 14-15 Task 재무비율 계산 로직 구현 가능성

---

## 📊 현재 데이터 현황

### 1. 재무제표 데이터 (DART API)
- **수집 종목:** 1,206개
- **총 레코드:** 2,352건
- **평균 레코드/종목:** 약 2건 (목표: 20건)
- **데이터 구조:** JSONB (JSON 형태)

### 2. 재무비율 데이터 (pykrx)
- **수집 종목:** 1,299개
- **총 레코드:** 914,085건
- **평균 레코드/종목:** 약 704건 (약 3년치)
- **수집 항목:** PER, PBR, EPS, BPS, DIV, DPS, ROE, Payout Ratio

---

## 🔍 샘플 종목 분석 결과 (10개)

### 재무제표 보유 종목 (5개)
1. **삼성바이오로직스 (207940)** - 재무제표 3건, 재무비율 731건
2. **삼성SDI (006400)** - 재무제표 3건, 재무비율 731건
3. **셀트리온 (068270)** - 재무제표 3건, 재무비율 731건
4. **기아 (000270)** - 재무제표 3건, 재무비율 731건
5. **삼성전자 (005930)** - 재무제표 3건, 재무비율 731건

**특징:**
- 모두 대형 우량주
- 재무제표 3건만 수집됨 (5년 × 4분기 = 20건 목표 대비 15% 수준)
- 재무비율은 pykrx로 3년치 수집 완료

### 재무비율만 보유 종목 (5개)
1. **화승알앤에이 (378850)** - 재무비율 731건
2. **SNT에너지 (100840)** - 재무비율 731건
3. **남화토건 (091590)** - 재무비율 731건
4. **대교우B (019685)** - 재무비율 731건
5. **강스템바이오텍 (217730)** - 재무비율 731건

**특징:**
- 재무제표 미수집 (DART API 수집 실패로 추정)
- 재무비율은 pykrx로 정상 수집

---

## 📄 재무제표 데이터 구조 분석 (삼성전자 예시)

### 1. 재무상태표 (Balance Sheet)
```json
{
  "assets": {
    "current": {
      "유동자산": 227062266000000.0,
      "비유동자산": 287469682000000.0,
      "기타유동자산": 6046740000000.0,
      "기타비유동자산": 16111070000000.0
    }
  },
  "equity": {
    "자본금": 897514000000.0,
    "자본총계": 402192070000000.0,
    "기타자본항목": 15873008000000.0
  },
  "liabilities": {
    "current": {
      "유동부채": 93326299000000.0,
      "비유동부채": 19013579000000.0
    }
  }
}
```

**사용 가능한 계정과목:**
- ✅ 자산총계 (유동자산 + 비유동자산)
- ✅ 부채총계 (유동부채 + 비유동부채)
- ✅ 자본총계
- ✅ 유동자산, 유동부채

### 2. 손익계산서 (Income Statement)
```json
{
  "revenue": {
    "매출액": 300870903000000.0,
    "매출원가": 186562268000000.0,
    "매출총이익": 114308635000000.0
  },
  "profit": {
    "영업이익": 32725961000000.0,
    "당기순이익": 34451351000000.0,
    "기본주당이익": 4950.0
  },
  "expenses": {
    "법인세비용차감전순이익": 37529734000000.0
  }
}
```

**사용 가능한 계정과목:**
- ✅ 매출액
- ✅ 매출원가, 매출총이익
- ✅ 영업이익
- ✅ 당기순이익
- ✅ EPS (기본주당이익)

### 3. 현금흐름표 (Cash Flow)
```json
{
  "operating": {
    "영업활동현금흐름": 72982621000000.0
  },
  "investing": {
    "투자활동현금흐름": -85381702000000.0
  },
  "financing": {
    "재무활동현금흐름": -7797243000000.0
  }
}
```

**사용 가능한 계정과목:**
- ✅ 영업활동현금흐름
- ✅ 투자활동현금흐름
- ✅ 재무활동현금흐름

---

## ✅ Day 14-15 Task 계산 가능성 평가

### Task 14.1: FinancialRatioCalculator 클래스 골격 - **가능** ✅

**필요 작업:**
- Python 클래스 구현
- JSONB 데이터 파싱 로직

---

### Task 14.2: 수익성 지표 계산 - **부분 가능** ⚠️

#### ✅ 계산 가능한 지표 (재무제표 사용)

1. **ROE (자기자본이익률)** = 당기순이익 / 자본총계 × 100
   - pykrx에서 이미 수집됨 (검증용으로 재계산 가능)
   - 재무제표: `income_statement.profit.당기순이익`, `balance_sheet.equity.자본총계`

2. **ROA (총자산이익률)** = 당기순이익 / 자산총계 × 100
   - 재무제표: `income_statement.profit.당기순이익`, `balance_sheet.assets.유동자산 + 비유동자산`

3. **매출총이익률** = 매출총이익 / 매출액 × 100
   - 재무제표: `income_statement.revenue.매출총이익`, `income_statement.revenue.매출액`

4. **영업이익률** = 영업이익 / 매출액 × 100
   - 재무제표: `income_statement.profit.영업이익`, `income_statement.revenue.매출액`

5. **순이익률** = 당기순이익 / 매출액 × 100
   - 재무제표: `income_statement.profit.당기순이익`, `income_statement.revenue.매출액`

#### ❌ 계산 불가능한 지표 (데이터 부족)

1. **ROIC (투하자본이익률)**
   - 필요: NOPAT (세후영업이익), Invested Capital (투하자본)
   - 부족: 세후영업이익 계산을 위한 유효세율 또는 영업이익에 대한 세금

2. **EBITDA 마진**
   - 필요: EBITDA (이자, 세금, 감가상각 전 이익)
   - 부족: 감가상각비 데이터 누락

---

### Task 14.3: 안정성 지표 계산 - **가능** ✅

#### ✅ 계산 가능한 지표

1. **부채비율** = 부채총계 / 자본총계 × 100
   - 재무제표: `balance_sheet.liabilities`, `balance_sheet.equity.자본총계`

2. **부채자본비율 (Debt-to-Equity)** = 부채총계 / 자본총계
   - 부채비율 / 100과 동일

3. **유동비율** = 유동자산 / 유동부채 × 100
   - 재무제표: `balance_sheet.assets.current.유동자산`, `balance_sheet.liabilities.current.유동부채`

4. **자기자본비율** = 자본총계 / 자산총계 × 100
   - 재무제표: `balance_sheet.equity.자본총계`, `balance_sheet.assets`

#### ⚠️ 부분 계산 가능

1. **당좌비율** = (유동자산 - 재고자산) / 유동부채 × 100
   - **문제:** 재고자산 항목이 현재 데이터에 명시적으로 없음
   - 가능한 대안: 유동자산 = 당좌자산 + 재고자산으로 추정

#### ❌ 계산 불가능

1. **이자보상배율** = 영업이익 / 이자비용
   - **문제:** 이자비용 항목 누락 (현재 "금융비용"만 있음, 이자비용 세분화 필요)

---

### Task 14.4: 활동성 지표 계산 - **부분 가능** ⚠️

#### ✅ 계산 가능

1. **총자산회전율** = 매출액 / 자산총계
   - 재무제표: `income_statement.revenue.매출액`, `balance_sheet.assets`

#### ❌ 계산 불가능 (세부 항목 부족)

1. **재고자산회전율** = 매출원가 / 평균재고자산
   - **문제:** 재고자산 항목 누락

2. **매출채권회전율** = 매출액 / 평균매출채권
   - **문제:** 매출채권 항목 누락

3. **매입채무회전율** = 매출원가 / 평균매입채무
   - **문제:** 매입채무 항목 누락

---

### Task 15.1: 성장성 지표 계산 - **가능** ✅

**전제조건:** 다년도 재무제표가 필요 (현재 평균 2-3건만 있어서 제한적)

#### ✅ 계산 가능 (데이터가 충분하다면)

1. **매출액 증가율** = (당기 매출액 - 전기 매출액) / 전기 매출액 × 100
2. **영업이익 증가율** = (당기 영업이익 - 전기 영업이익) / 전기 영업이익 × 100
3. **순이익 증가율** = (당기 순이익 - 전기 순이익) / 전기 순이익 × 100
4. **EPS 증가율** = (당기 EPS - 전기 EPS) / 전기 EPS × 100
5. **총자산 증가율** = (당기 자산총계 - 전기 자산총계) / 전기 자산총계 × 100

**현재 문제점:**
- 재무제표가 평균 2-3건만 있어서 성장률 계산이 제한적
- 5년치 데이터 필요 → 현재 수집 로직 개선 필요

---

### Task 15.2: 밸류에이션 지표 계산 - **부분 가능** ⚠️

#### ✅ pykrx에서 이미 수집됨 (검증 가능)

1. **PER (주가수익비율)** = 주가 / EPS
   - pykrx에서 수집 완료 ✅

2. **PBR (주가순자산비율)** = 주가 / BPS
   - pykrx에서 수집 완료 ✅

#### ⚠️ 재무제표로 계산 가능 (주가 데이터 필요)

3. **BPS (주당순자산)** = 자본총계 / 발행주식수
   - 재무제표: `balance_sheet.equity.자본총계`
   - **문제:** 발행주식수 데이터 필요 (자본금 / 액면가로 추정 가능)

#### ❌ 계산 어려움 (복잡한 데이터 필요)

1. **PSR (주가매출액비율)** = 시가총액 / 매출액
   - 필요: 시가총액 (주가 × 발행주식수)

2. **PCR (주가현금흐름비율)** = 주가 / 주당현금흐름
   - 필요: 주당현금흐름 계산

3. **EV/EBITDA** = 기업가치 / EBITDA
   - 필요: 시가총액, 순차입금, EBITDA
   - **문제:** EBITDA 계산 불가 (감가상각비 부족)

---

### Task 15.3: Magic Formula 지표 계산 - **부분 가능** ⚠️

#### ✅ 계산 가능

1. **Earnings Yield (이익수익률)** = EBIT / 기업가치
   - EBIT ≈ 영업이익 (재무제표에서 제공)
   - 기업가치 = 시가총액 + 순차입금
   - **문제:** 순차입금 = 차입금 - 현금성자산 세부 항목 필요

#### ❌ 계산 어려움

2. **ROIC (투하자본이익률)**
   - 앞서 언급한 대로 NOPAT, Invested Capital 계산 어려움

---

## 📋 결론 및 권장 사항

### ✅ 현재 계산 가능한 지표 (재무제표 기반)

**수익성 지표 (5개)**
1. ROE (자기자본이익률) ✅
2. ROA (총자산이익률) ✅
3. 매출총이익률 ✅
4. 영업이익률 ✅
5. 순이익률 ✅

**안정성 지표 (4개)**
1. 부채비율 ✅
2. 부채자본비율 ✅
3. 유동비율 ✅
4. 자기자본비율 ✅

**활동성 지표 (1개)**
1. 총자산회전율 ✅

**성장성 지표 (5개)** - 데이터 충분 시
1. 매출액 증가율 ⚠️
2. 영업이익 증가율 ⚠️
3. 순이익 증가율 ⚠️
4. EPS 증가율 ⚠️
5. 총자산 증가율 ⚠️

**총계: 약 15개 지표** 계산 가능 (재무제표 데이터 개선 시)

---

### ⚠️ pykrx로 이미 수집된 지표

다음 지표는 재무제표로 계산할 필요 없이 이미 수집 완료:
1. PER ✅
2. PBR ✅
3. EPS ✅
4. BPS ✅
5. ROE ✅
6. 배당수익률 (DIV) ✅
7. 주당배당금 (DPS) ✅
8. 배당성향 (Payout Ratio) ✅

---

### ❌ 계산 불가능한 지표 (데이터 부족)

1. **ROIC** - NOPAT, Invested Capital 계산 불가
2. **EBITDA 마진** - 감가상각비 데이터 부족
3. **당좌비율** - 재고자산 항목 부족
4. **이자보상배율** - 이자비용 세분화 필요
5. **재고자산회전율** - 재고자산 항목 부족
6. **매출채권회전율** - 매출채권 항목 부족
7. **매입채무회전율** - 매입채무 항목 부족
8. **PSR** - 시가총액 필요
9. **PCR** - 주당현금흐름 계산 복잡
10. **EV/EBITDA** - EBITDA 계산 불가

---

## 🎯 권장 조치사항

### 1. 재무제표 수집 개선 (최우선)

**현재 문제:**
- 평균 2-3건만 수집 (목표: 20건)
- 5년치 데이터 부족으로 성장률 계산 제한

**해결 방법:**
```bash
# DART API 수집 스크립트 점검 및 재수집
python scripts/batch_collect_financials.py --years 5 --quarterly
```

### 2. 재무제표 데이터 구조 개선

**현재 문제:**
- 계정과목이 너무 상위 레벨로 집계됨
- 예: "유동자산" (집계값)만 있고, "재고자산", "매출채권" 등 세부 항목 부족

**해결 방법:**
- DART API 파싱 로직 개선
- 세부 계정과목까지 수집하도록 변경

### 3. Day 14-15 Task 수정 제안

**현재 계획:**
- Task 14-15: 33개 재무비율 모두 계산

**수정 제안:**
- **Phase 1:** 현재 데이터로 계산 가능한 15개 지표만 우선 구현
- **Phase 2:** 재무제표 수집 개선 후 나머지 지표 추가

**Phase 1 대상 (15개):**
- 수익성: ROE, ROA, 매출총이익률, 영업이익률, 순이익률
- 안정성: 부채비율, 부채자본비율, 유동비율, 자기자본비율
- 활동성: 총자산회전율
- 성장성: 매출액/영업이익/순이익/EPS/자산 증가율 (데이터 개선 시)

**Phase 2 대상 (나머지):**
- 재무제표 수집 개선 후 구현
- 또는 pykrx 등 다른 소스에서 수집

### 4. pykrx 데이터 활용

**현재 상황:**
- pykrx에서 이미 PER, PBR, EPS, BPS, ROE 등 수집 완료
- 1,299개 종목, 914,085건 데이터

**권장:**
- 재무제표 기반 계산 지표와 pykrx 수집 지표 교차 검증
- 불일치 시 원인 분석 및 데이터 품질 개선

---

## 📊 최종 평가

### Day 14-15 Task 실행 가능성

**Task 14.1-14.5:** ✅ **가능** (15개 지표)
- 재무제표로 계산 가능한 기본 지표 구현
- 데이터 구조 개선 필요하지만 현재 데이터로도 시작 가능

**Task 15.1:** ⚠️ **조건부 가능** (성장성 지표)
- 재무제표 수집 개선 후 가능
- 현재는 2-3건만 있어서 제한적

**Task 15.2:** ⚠️ **부분 가능** (밸류에이션)
- pykrx에서 이미 수집됨 (PER, PBR)
- 추가 지표는 데이터 보완 필요

**Task 15.3:** ❌ **어려움** (Magic Formula)
- ROIC 계산 불가
- Earnings Yield는 일부 가능

**종합 평가:** **60% 가능**
- 33개 중 약 20개 지표 계산 가능 (pykrx 포함)
- 재무제표 수집 개선 시 추가 지표 가능

---

**문서 버전:** 1.0
**작성일:** 2025-10-21
